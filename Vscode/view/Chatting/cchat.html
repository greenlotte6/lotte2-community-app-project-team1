<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>채팅</title>
    <!-- Pretendard 웹 폰트 연결 -->
    <link
      rel="stylesheet"
      as="style"
      crossorigin
      href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css"
    />
    <!-- 기존 Admin 전용 CSS -->
    <link rel="stylesheet" href="/css/main/Admin/adminEmploy.css" />
    <!-- Chatting 전용 CSS -->
    <link rel="stylesheet" href="/css/main/Chatting/ChattingMain.css" />
    <!-- 관리자용 스크립트 (예: 다크모드 토글 등) -->
    <script src="/scripts/adminEmploy.js"></script>
  </head>
  <body>
    <div class="wrapper">
      <!-- ───────────────────────────────────────────────────────────
           사이드바 영역
           ─────────────────────────────────────────────────────────── -->
      <div class="wrapperside">
        <div class="profileArea">
          <img src="/images/user.png" alt="profile" />
        </div>
        <ul>
          <li>
            <a href="/view/Admin/adminMain.html"
              ><img src="/images/Grid.svg" alt="dashboard"
            /></a>
          </li>
          <li>
            <a href="/view/MyPage/MyPage.html"
              ><img src="/images/File text.svg" alt="document"
            /></a>
          </li>
          <li>
            <a href="/view/Calendar/calendar.html"
              ><img src="/images/Calendar.svg" alt="calendar"
            /></a>
          </li>
          <li>
            <a href="/view/Chatting/Chatting.html"
              ><img src="/images/Message square.svg" alt="message"
            /></a>
          </li>
          <li>
            <a href="/view/Board/board.html"
              ><img src="/images/Clipboard.svg" alt="message-board"
            /></a>
          </li>
          <li>
            <a href="/view/Project/Project.html"
              ><img src="/images/gmail_groups.svg" alt="director"
            /></a>
          </li>
          <li>
            <a href="/view/Cloud/cloudhome.html"
              ><img src="/images/Cloud.svg" alt="cloud-computing"
            /></a>
          </li>
          <li>
            <a href="/view/Setting/Setting.html"
              ><img src="/images/Settings.svg" alt="setting"
            /></a>
          </li>
        </ul>
      </div>

      <!-- ───────────────────────────────────────────────────────────
           메인 컨테이너 영역
           ─────────────────────────────────────────────────────────── -->
      <div class="container">
        <!-- ───────────────────────────────────────────────────────────
             상단 헤더 영역
             ─────────────────────────────────────────────────────────── -->
        <header>
          <div class="headerArea">
            <div class="headerlogo">
              <a href="#"><img src="/images/logo.png" alt="J2SMLogo" /></a>
            </div>
            <div class="darkmode">
              <label class="toggle-switch">
                <span class="label-text">DARK MODE</span>
                <input type="checkbox" id="darkModeToggle" />
                <span class="slider"></span>
              </label>
            </div>
            <div class="alert">
              <img src="/images/bell.png" alt="bell" />
            </div>
          </div>
        </header>

        <!-- ───────────────────────────────────────────────────────────
             메인 콘텐츠 영역 (사이드바 + 내용)
             ─────────────────────────────────────────────────────────── -->
        <main>
          <!-- ─────────────────────────────────────────────────────────
               좌측 사이드바 (Chatting 메뉴 포함)
               ───────────────────────────────────────────────────────── -->
          <aside>
            <div class="sidemenu" id="chatting">
              <div class="sideTop">
                <h3>Chatting</h3>
              </div>
              <div class="sidelink"><a href="#">+ 채널 추가</a></div>
              <div class="childArea">
                <div>
                  <img src="/images/Home.svg" alt="users" />
                  <a href="/view/Admin/adminMain.html">Home</a>
                  <img src="/images/Vector.svg" alt="vector" />
                </div>
                <div>
                  <img src="/images/Users.svg" alt="users" />
                  <a href="/view/Admin/adminEmploy.html">Employee Management</a>
                  <img src="/images/Vector.svg" alt="vector" />
                </div>
                <div>
                  <img src="/images/Users.svg" alt="users" />
                  <a href="/view/Admin/adminMembership.html">MemberShip</a>
                  <img src="/images/Vector.svg" alt="vector" />
                </div>
                <div>
                  <img src="/images/Users.svg" alt="users" />
                  <a href="#">Payment details</a>
                  <img src="/images/Vector.svg" alt="vector" />
                </div>
              </div>
            </div>
          </aside>

          <!-- ─────────────────────────────────────────────────────────
               우측 콘텐츠 영역 (채팅 화면)
               ───────────────────────────────────────────────────────── -->
          <div class="contentArea">
            <div class="topArea">
              <div class="Title">
                <h3>채팅 카테고리</h3>
              </div>
              <!-- 검색바 + 새 채팅방 버튼 -->
              <div class="controlBar">
                <input
                  type="text"
                  id="searchCategory"
                  placeholder="채팅방 검색..."
                  class="searchInput"
                />
                <button id="createRoomBtn" class="createBtn">
                  + 새 채팅방 만들기
                </button>
              </div>
            </div>

            <!-- ============ 채팅 카테고리 목록 시작 ============ -->
            <div class="categoryContainer">
              <!-- 개별 카테고리 항목 예시 -->
              <a href="/view/Chatting/Chatting.html" class="categoryItem">
                <div class="itemLeft">
                  <div class="itemTitle">일반 대화</div>
                  <div class="itemDesc">자유롭게 소통하는 공간</div>
                  <div class="lastMessage">[민수] 오늘 점심 뭐 드실래요?</div>
                </div>
                <div class="itemRight">
                  <span class="unreadBadge">5</span>
                  <div class="participants">
                    <img src="/images/user.png" alt="member" />
                    <img src="/images/user.png" alt="member" />
                    <img src="/images/user.png" alt="member" />
                  </div>
                </div>
              </a>

              <a href="/view/Chatting/Chatting.html" class="categoryItem">
                <div class="itemLeft">
                  <div class="itemTitle">공지사항</div>
                  <div class="itemDesc">회사 전반 공지 및 안내</div>
                  <div class="lastMessage">
                    [관리자] 이번 주 금요일 정기점검 안내
                  </div>
                </div>
                <div class="itemRight">
                  <span class="unreadBadge">0</span>
                  <div class="participants">
                    <img src="/images/user.png" alt="member" />
                  </div>
                </div>
              </a>

              <a href="/view/Chatting/Chatting.html" class="categoryItem">
                <div class="itemLeft">
                  <div class="itemTitle">프로젝트 A팀</div>
                  <div class="itemDesc">A팀 개발 진행 상황 공유</div>
                  <div class="lastMessage">[지영] 리뷰 요청 드려요.</div>
                </div>
                <div class="itemRight">
                  <span class="unreadBadge">2</span>
                  <div class="participants">
                    <img src="/images/user.png" alt="member" />
                    <img src="/images/user.png" alt="member" />
                  </div>
                </div>
              </a>

              <a href="/view/Chatting/Chatting.html" class="categoryItem">
                <div class="itemLeft">
                  <div class="itemTitle">IT 지원</div>
                  <div class="itemDesc">개발/인프라 기술 지원</div>
                  <div class="lastMessage">[민준] VPN 연결이 안 돼요.</div>
                </div>
                <div class="itemRight">
                  <span class="unreadBadge">1</span>
                  <div class="participants">
                    <img src="/images/user.png" alt="member" />
                    <img src="/images/user.png" alt="member" />
                  </div>
                </div>
              </a>

              <!-- 실제 환경에서는 서버에서 불러온 데이터를 반복 렌더링 -->
            </div>
            <!-- ============ 채팅 카테고리 목록 끝 ============ -->
          </div>
        </main>

        <!-- ───────────────────────────────────────────────────────────
             모달 오버레이 영역 (사원 초대)
             ─────────────────────────────────────────────────────────── -->
        <div class="modalOverlay" id="inviteModal">
          <div class="modalContent">
            <h3>사원 초대</h3>
            <input type="text" placeholder="회사명 입력" />
            <input type="text" placeholder="부서 입력" />
            <input type="text" placeholder="직책 입력" />
            <input type="text" placeholder="성명 입력" />
            <input type="text" placeholder="이메일 입력" />
            <div class="modalButtons">
              <button id="inviteConfirmBtn">초대</button>
              <button id="inviteCancelBtn">취소</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- =============================================
         JavaScript 로직: 스크롤 + 전송 버튼 기능
         ============================================= -->
    <script>
      // 1) 페이지 로드 시, 기존 메시지가 있으면 맨 아래로 자동 스크롤
      document.addEventListener("DOMContentLoaded", () => {
        const messagesDiv = document.getElementById("messages");
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
      });

      // 2) 전송 버튼 클릭 시 동작
      document.getElementById("sendBtn").addEventListener("click", () => {
        const inputEl = document.getElementById("inputMessage");
        const text = inputEl.value.trim();
        if (!text) return; // 빈 문자열이면 아무 동작 안함

        // 새로운 메시지 요소 생성
        const newMsg = document.createElement("div");
        newMsg.classList.add("chat-message", "mine");

        // 메타 정보: 사용자명 + 시간
        const meta = document.createElement("div");
        meta.classList.add("message-meta");

        const userSpan = document.createElement("span");
        userSpan.classList.add("message-user");
        userSpan.textContent = "홍길동"; // 실제 로그인된 사용자명으로 변경

        const timeSpan = document.createElement("span");
        timeSpan.classList.add("message-time");
        // 현재 시간 구하기 (예: "HH:MM")
        const now = new Date();
        const hh = now.getHours().toString().padStart(2, "0");
        const mm = now.getMinutes().toString().padStart(2, "0");
        timeSpan.textContent = `${hh}:${mm}`;

        meta.appendChild(userSpan);
        meta.appendChild(timeSpan);

        // 메시지 내용
        const content = document.createElement("div");
        content.classList.add("message-content");
        content.textContent = text;

        newMsg.appendChild(meta);
        newMsg.appendChild(content);

        // messages 영역에 삽입 후 스크롤 맨 아래로 내리기
        const messagesDiv = document.getElementById("messages");
        messagesDiv.insertBefore(
          newMsg,
          document.getElementById("bottom-anchor")
        );
        messagesDiv.scrollTop = messagesDiv.scrollHeight;

        // 입력창 초기화
        inputEl.value = "";
      });

      // 3) 다크 모드 토글 (input#darkModeToggle 체크박스)
      const darkToggle = document.getElementById("darkModeToggle");
      darkToggle.addEventListener("change", (e) => {
        if (e.target.checked) {
          document.body.classList.add("dark-mode");
        } else {
          document.body.classList.remove("dark-mode");
        }
      });
    </script>
  </body>
</html>
